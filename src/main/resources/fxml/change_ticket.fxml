<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.shape.*?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="com.cinema.controller.ChangeTicketController"
            styleClass="main-background">
    
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="header-bar">
            <padding>
                <Insets top="15" right="30" bottom="15" left="30"/>
            </padding>
            
            <!-- Back Button -->
            <Button text="â† Back" onAction="#handleBack" styleClass="btn-back"/>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <Label text="Change Ticket" styleClass="header-movie-title"/>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <!-- Original ticket info -->
            <VBox alignment="CENTER_RIGHT">
                <Label fx:id="originalTicketLabel" text="Original: Customer Name" styleClass="original-ticket-info"/>
                <Label fx:id="originalScreeningLabel" text="Movie - Date - Time" styleClass="original-ticket-info"/>
            </VBox>
        </HBox>
    </top>
    
    <center>
        <HBox spacing="30">
            <padding>
                <Insets top="20" right="30" bottom="20" left="30"/>
            </padding>
            
            <!-- Left Side: New Screening Selection -->
            <VBox spacing="15" HBox.hgrow="ALWAYS">
                <Label text="Select New Screening" styleClass="section-subtitle"/>
                
                <!-- Date and Search -->
                <HBox spacing="15" alignment="CENTER_LEFT">
                    <Label text="Date:" styleClass="field-label"/>
                    <DatePicker fx:id="datePicker" styleClass="date-picker-custom"/>
                    <Button text="Search" onAction="#handleSearch" styleClass="btn-search"/>
                </HBox>
                
                <!-- Available Screenings -->
                <Label text="Available Screenings:" styleClass="field-label"/>
                <ScrollPane fitToWidth="true" styleClass="screenings-scroll" VBox.vgrow="ALWAYS">
                    <VBox fx:id="screeningsListBox" spacing="10">
                        <padding>
                            <Insets top="10" right="10" bottom="10" left="10"/>
                        </padding>
                    </VBox>
                </ScrollPane>
            </VBox>
            
            <!-- Right Side: Seat Selection (shown when screening is selected) -->
            <VBox fx:id="seatSelectionPanel" spacing="15" minWidth="400" visible="false" managed="false">
                <Label fx:id="newScreeningInfoLabel" text="New Screening Info" styleClass="section-subtitle"/>
                
                <!-- Seat Legend -->
                <HBox alignment="CENTER" spacing="20">
                    <HBox alignment="CENTER" spacing="5">
                        <Rectangle width="20" height="20" styleClass="seat-available" arcWidth="3" arcHeight="3"/>
                        <Label text="Available" styleClass="legend-label-small"/>
                    </HBox>
                    <HBox alignment="CENTER" spacing="5">
                        <Rectangle width="20" height="20" styleClass="seat-selected" arcWidth="3" arcHeight="3"/>
                        <Label text="Selected" styleClass="legend-label-small"/>
                    </HBox>
                    <HBox alignment="CENTER" spacing="5">
                        <Rectangle width="20" height="20" styleClass="seat-reserved" arcWidth="3" arcHeight="3"/>
                        <Label text="Reserved" styleClass="legend-label-small"/>
                    </HBox>
                </HBox>
                
                <!-- Seats Grid -->
                <VBox alignment="CENTER" styleClass="seats-container-small">
                    <padding>
                        <Insets top="15" right="20" bottom="15" left="20"/>
                    </padding>
                    <GridPane fx:id="seatsGrid" hgap="5" vgap="5" alignment="CENTER"/>
                    <Region prefHeight="10"/>
                    <StackPane>
                        <Rectangle width="250" height="20" styleClass="screen-shape" arcWidth="3" arcHeight="3"/>
                        <Label text="SCREEN" styleClass="screen-label-small"/>
                    </StackPane>
                </VBox>
                
                <Label fx:id="selectedSeatsLabel" text="Selected: 0 seats" styleClass="selected-seats-label"/>
                
                <!-- Confirm Change Button -->
                <Button fx:id="confirmButton" text="Confirm Change" onAction="#handleConfirmChange" 
                        styleClass="btn-primary" disable="true" maxWidth="Infinity"/>
            </VBox>
        </HBox>
    </center>
</BorderPane>
